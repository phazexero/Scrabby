<html><head><title>Just-In-Time Link-Time Optimizations — cuFFT LTO EA 11.1.3 documentation</title></head><body><body class="wy-body-for-nav">
 <a class="icon icon-home" href="https://docs.nvidia.com/cuda/cufft/ltoea/index.html">
  cuFFT LTO EA
 </a>
 11.1.3
 <ul>
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/index.html">
    Documentation home
   </a>
  </li>
 </ul>
 <p class="caption" role="heading">
  <span class="caption-text">
   User guide
  </span>
 </p>
 <ul class="current">
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/getting_started/index.html">
    Quick start
   </a>
  </li>
  <li class="toctree-l1 current">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/index.html">
    How to use cuFFT LTO EA
   </a>
   <ul class="current">
    <li class="toctree-l2 current">
     <a class="current reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html">
      Just-In-Time Link-Time Optimizations
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#what-is-jit-lto">
        What is JIT LTO?
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#jit-lto-in-cufft-lto-ea">
        JIT LTO in cuFFT LTO EA
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#the-cost-of-jit-lto">
        The cost of JIT LTO
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/requirements.html">
      Requirements
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/requirements.html#software-requirements">
        Software requirements
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html">
      API usage
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#generating-the-lto-callback">
        Generating the LTO callback
       </a>
       <ul>
        <li class="toctree-l4">
         <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#offline-compilation">
          Offline compilation
         </a>
        </li>
        <li class="toctree-l4">
         <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#using-nvrtc">
          Using NVRTC
         </a>
        </li>
       </ul>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#associating-the-lto-callback-with-the-cufft-plan">
        Associating the LTO callback with the cuFFT plan
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/supported_functionalities.html">
      Supported functionalities
     </a>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/tips.html">
      Frequently asked questions
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/tips.html#i-am-getting-an-error-with-the-message-error-cufftxtsetjitcallback-was-not-declared-in-this-scope">
        I am getting an error with the message: âerror: âcufftXtSetJITCallbackâ was not declared in this scopeâ
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/tips.html#i-am-getting-an-error-with-the-message-undefined-reference-to-cufftxtsetjitcallback">
        I am getting an error with the message: âundefined reference to âcufftXtSetJITCallbackââ
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/tips.html#my-existing-callback-works-fine-without-lto-using-cufftxtsetcallback-but-planning-fails-when-attempting-to-use-lto-callbacks-cufftxtsetjitcallback">
        My existing callback works fine without LTO (using cufftXtSetCallback) but planning fails when attempting to use LTO callbacks (
        <span class="xref std std-ref">
         cufftXtSetJITCallback
        </span>
        )
       </a>
      </li>
     </ul>
    </li>
   </ul>
  </li>
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html">
    API reference
   </a>
   <ul>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#associating-lto-callbacks-with-cufft-plan">
      Associating LTO callbacks with cuFFT Plan
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#cufftxtsetjitcallback">
        cufftXtSetJITCallback
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#lto-callback-signatures">
      LTO callback signatures
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#load-single-precision-complex">
        Load Single-Precision Complex
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#load-double-precision-complex">
        Load Double-Precision Complex
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#load-single-precision-real">
        Load Single-Precision Real
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#load-double-precision-real">
        Load Double-Precision Real
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#store-single-precision-complex">
        Store Single-Precision Complex
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#store-double-precision-complex">
        Store Double-Precision Complex
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#store-single-precision-real">
        Store Single-Precision Real
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#store-double-precision-real">
        Store Double-Precision Real
       </a>
      </li>
     </ul>
    </li>
   </ul>
  </li>
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html">
    Release Notes
   </a>
   <ul>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#cufft-lto-ea-preview-11-1-3-0">
      cuFFT LTO EA preview 11.1.3.0
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#new-features">
        New features
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#known-issues">
        Known issues
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#cufft-lto-ea-preview-11-1-0-0">
      cuFFT LTO EA preview 11.1.0.0
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#id1">
        New features
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#id2">
        Known issues
       </a>
      </li>
     </ul>
    </li>
   </ul>
  </li>
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/contact_us/index.html">
    Contact us
   </a>
   <ul>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/contact_us/index.html#questions-suggestions">
      Questions? Suggestions?
     </a>
    </li>
   </ul>
  </li>
 </ul>
 <a href="https://docs.nvidia.com/cuda/cufft/ltoea/index.html">
  cuFFT LTO EA
 </a>
 <ul class="wy-breadcrumbs">
  <li class="breadcrumb-item">
   <a href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/index.html">
    How to use cuFFT LTO EA
   </a>
  </li>
  <li class="breadcrumb-item active">
   Just-In-Time Link-Time Optimizations
  </li>
 </ul>
 <h1>
  Just-In-Time Link-Time Optimizations
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#just-in-time-link-time-optimizations" title="Permalink to this heading">
   Â¶
  </a>
 </h1>
 <h2>
  What is JIT LTO?
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#what-is-jit-lto" title="Permalink to this heading">
   Â¶
  </a>
 </h2>
 <p>
  <a class="reference external" href="https://developer.nvidia.com/blog/improving-gpu-app-performance-with-cuda-11-2-device-lto/">
   Link-Time Optimization (LTO)
  </a>
  is a powerful tool that brings whole-program optimization to applications that are built with separate compilation.
For CUDA applications, LTO was introduced for the first time in CUDA 11.2. When LTO is applied as part of the application
building process using the nvcc compiler, we call it
  offline LTO
  .
 </p>
 <p>
  We can also apply LTO optimizations at runtime, when the application is executed. We call this process
  Just-In-Time (JIT)
LTO
  . JIT LTO allows libraries to finalize at runtime only the kernels requested by the user, instead of all possible kernels.
 </p>
 <p>
  JIT LTO is implemented using the
  <a class="reference external" href="https://docs.nvidia.com/cuda/nvjitlink/index.html">
   nvJitLink library
  </a>
  ,
which was
  <a class="reference external" href="https://developer.nvidia.com/blog/cuda-12-0-compiler-support-for-runtime-lto-using-nvjitlink-library/">
   introduced in CUDA 12.0
  </a>
  .
 </p>
 <h2>
  JIT LTO in cuFFT LTO EA
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#jit-lto-in-cufft-lto-ea" title="Permalink to this heading">
   Â¶
  </a>
 </h2>
 <p>
  In this preview, we decided to apply JIT LTO to the callback kernels that have been part of cuFFT since CUDA 6.5.
There are currently two main benefits of LTO-enabled callbacks in cuFFT, when compared to non-LTO callbacks.
 </p>
 <p>
  First, JIT LTO allows us to inline the user callback code inside the cuFFT kernel. Once the callback has been inlined,
the optimization process takes place with full kernel visibility. Without JIT LTO, user callbacks were compiled separately
and indirectly called from within the cuFFT kernel using function pointers. The result of using LTO is a noticeable improvement
in performance for some callback use cases due to the removal of the overhead of indirect function calls to the callback.
 </p>
 <p>
  In other words, JIT LTO allows us to seamlessly combine user code with library code at runtime.
 </p>
 <p>
  Secondly, the runtime aspect of JIT LTO means we do not need to build all possible kernels beforehand to be shipped with the
library; only the kernels requested by the user at plan time need to be finalized. cuFFT will expand on this idea in future
releases to bring additional functioanlity and Speed-of-Light performance that were previously impossible to ship without
compromising binary size.
 </p>
 <p>
  cuFFT LTO EA includes a sample of this additional performance for LTO callback kernels:
 </p>
 <p>
  The chart above illustrates the performance gains of using LTO callbacks when compared to non-LTO callbacks in cuFFT
distributed in the CUDA Toolkit 11.7. The benchmark runs Complex-to-Complex (C2C) FFTs in single precision, with
minimal load and store callbacks, on an Ampere GPU (A100 with 80 GB).
 </p>
 <h2>
  The cost of JIT LTO
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#the-cost-of-jit-lto" title="Permalink to this heading">
   Â¶
  </a>
 </h2>
 <p>
  When using JIT LTO, kernel finalization happens at runtime, rather than when the library is built. This runtime component is
a great advantage over offline LTO: since with offline LTO we do not know which kernels are going to be run,
we need to link the whole library with the user callback code, which is a slow and delicate process.
 </p>
 <p>
  The drawback of finalizing the kernel at runtime is the overhead of kernel finalization at plan time. We have measured most
cases to be between 50 and 500 ms of overhead at plan time per kernel. This compares to about 250 ms of library initialization
in older versions of cuFFT shipped in CUDA 10.X, and less than 200 ms per kernel in CUDA 11.X and newer versions, due to PTX JIT.
 </p>
 <p>
  Please keep in mind that these times are an estimation and actual times vary with the characteristics of the system used to
run the application, i.e. CPU power. Also note that starting from CUDA 12.1, nvJitLink uses a cache to greatly reduce the overhead
of runtime linking for kernels across multiple runs.
 </p>
 <a accesskey="p" class="btn btn-neutral float-left" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/index.html" rel="prev" title="How to use cuFFT LTO EA">
  Previous
 </a>
 <a accesskey="n" class="btn btn-neutral float-right" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/requirements.html" rel="next" title="Requirements">
  Next
 </a>
 <p style="color: gray;">
  <a href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/" style="color: inherit;" target="_blank">
   Privacy Policy
  </a>
  |
  <a href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/" style="color: inherit;" target="_blank">
   Manage My Privacy
  </a>
  |
  <a href="https://www.nvidia.com/en-us/preferences/start/" style="color: inherit;" target="_blank">
   Do Not Sell or Share My Data
  </a>
  |
  <a href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/" style="color: inherit;" target="_blank">
   Terms of Service
  </a>
  |
  <a href="https://www.nvidia.com/en-us/about-nvidia/accessibility/" style="color: inherit;" target="_blank">
   Accessibility
  </a>
  |
  <a href="https://www.nvidia.com/en-us/about-nvidia/company-policies/" style="color: inherit;" target="_blank">
   Corporate Policies
  </a>
  |
  <a href="https://www.nvidia.com/en-us/product-security/" style="color: inherit;" target="_blank">
   Product Security
  </a>
  |
  <a href="https://www.nvidia.com/en-us/contact/" style="color: inherit;" target="_blank">
   Contact
  </a>
 </p>
 <p>
  Copyright © 2023-2024, NVIDIA Corporation and affiliates.
 </p>
</body>
</body></html>