<html><head><title>API usage — cuFFT LTO EA 11.1.3 documentation</title></head><body><body class="wy-body-for-nav">
 <a class="icon icon-home" href="https://docs.nvidia.com/cuda/cufft/ltoea/index.html">
  cuFFT LTO EA
 </a>
 11.1.3
 <ul>
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/index.html">
    Documentation home
   </a>
  </li>
 </ul>
 <p class="caption" role="heading">
  <span class="caption-text">
   User guide
  </span>
 </p>
 <ul class="current">
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/getting_started/index.html">
    Quick start
   </a>
  </li>
  <li class="toctree-l1 current">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/index.html">
    How to use cuFFT LTO EA
   </a>
   <ul class="current">
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html">
      Just-In-Time Link-Time Optimizations
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#what-is-jit-lto">
        What is JIT LTO?
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#jit-lto-in-cufft-lto-ea">
        JIT LTO in cuFFT LTO EA
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/jit_lto.html#the-cost-of-jit-lto">
        The cost of JIT LTO
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/requirements.html">
      Requirements
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/requirements.html#software-requirements">
        Software requirements
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2 current">
     <a class="current reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html">
      API usage
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#generating-the-lto-callback">
        Generating the LTO callback
       </a>
       <ul>
        <li class="toctree-l4">
         <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#offline-compilation">
          Offline compilation
         </a>
        </li>
        <li class="toctree-l4">
         <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#using-nvrtc">
          Using NVRTC
         </a>
        </li>
       </ul>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#associating-the-lto-callback-with-the-cufft-plan">
        Associating the LTO callback with the cuFFT plan
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/supported_functionalities.html">
      Supported functionalities
     </a>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/tips.html">
      Frequently asked questions
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/tips.html#i-am-getting-an-error-with-the-message-error-cufftxtsetjitcallback-was-not-declared-in-this-scope">
        I am getting an error with the message: âerror: âcufftXtSetJITCallbackâ was not declared in this scopeâ
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/tips.html#i-am-getting-an-error-with-the-message-undefined-reference-to-cufftxtsetjitcallback">
        I am getting an error with the message: âundefined reference to âcufftXtSetJITCallbackââ
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/tips.html#my-existing-callback-works-fine-without-lto-using-cufftxtsetcallback-but-planning-fails-when-attempting-to-use-lto-callbacks-cufftxtsetjitcallback">
        My existing callback works fine without LTO (using cufftXtSetCallback) but planning fails when attempting to use LTO callbacks (
        <span class="xref std std-ref">
         cufftXtSetJITCallback
        </span>
        )
       </a>
      </li>
     </ul>
    </li>
   </ul>
  </li>
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html">
    API reference
   </a>
   <ul>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#associating-lto-callbacks-with-cufft-plan">
      Associating LTO callbacks with cuFFT Plan
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#cufftxtsetjitcallback">
        cufftXtSetJITCallback
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#lto-callback-signatures">
      LTO callback signatures
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#load-single-precision-complex">
        Load Single-Precision Complex
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#load-double-precision-complex">
        Load Double-Precision Complex
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#load-single-precision-real">
        Load Single-Precision Real
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#load-double-precision-real">
        Load Double-Precision Real
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#store-single-precision-complex">
        Store Single-Precision Complex
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#store-double-precision-complex">
        Store Double-Precision Complex
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#store-single-precision-real">
        Store Single-Precision Real
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#store-double-precision-real">
        Store Double-Precision Real
       </a>
      </li>
     </ul>
    </li>
   </ul>
  </li>
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html">
    Release Notes
   </a>
   <ul>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#cufft-lto-ea-preview-11-1-3-0">
      cuFFT LTO EA preview 11.1.3.0
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#new-features">
        New features
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#known-issues">
        Known issues
       </a>
      </li>
     </ul>
    </li>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#cufft-lto-ea-preview-11-1-0-0">
      cuFFT LTO EA preview 11.1.0.0
     </a>
     <ul>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#id1">
        New features
       </a>
      </li>
      <li class="toctree-l3">
       <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/release_notes.html#id2">
        Known issues
       </a>
      </li>
     </ul>
    </li>
   </ul>
  </li>
  <li class="toctree-l1">
   <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/contact_us/index.html">
    Contact us
   </a>
   <ul>
    <li class="toctree-l2">
     <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/contact_us/index.html#questions-suggestions">
      Questions? Suggestions?
     </a>
    </li>
   </ul>
  </li>
 </ul>
 <a href="https://docs.nvidia.com/cuda/cufft/ltoea/index.html">
  cuFFT LTO EA
 </a>
 <ul class="wy-breadcrumbs">
  <li class="breadcrumb-item">
   <a href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/index.html">
    How to use cuFFT LTO EA
   </a>
  </li>
  <li class="breadcrumb-item active">
   API usage
  </li>
 </ul>
 <h1>
  API usage
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#api-usage" title="Permalink to this heading">
   Â¶
  </a>
 </h1>
 <p>
  Usage of LTO-callbacks in cuFFT LTO EA is divided in two parts:
 </p>
 <ul class="simple">
  <li>
   <p>
    Generating the LTO callback (i.e. compiling the callback to LTO-IR).
   </p>
  </li>
  <li>
   <p>
    Associating the LTO callback with the cuFFT plan.
   </p>
  </li>
 </ul>
 <h2>
  Generating the LTO callback
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#generating-the-lto-callback" title="Permalink to this heading">
   Â¶
  </a>
 </h2>
 <p>
  cuFFT LTO EA currently supports two ways of generating the LTO-callback (i.e. callback code compiled to LTO-IR).
 </p>
 <h3>
  Offline compilation
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#offline-compilation" title="Permalink to this heading">
   Â¶
  </a>
 </h3>
 <p>
  The callback code can be compiled to LTO-IR using
  <span class="pre">
   nvcc
  </span>
  with any of the supported flags (such as
  <span class="pre">
   -dlto
  </span>
  or
  <span class="pre">
   -gencode=arch=compute_XX,code=lto_XX
  </span>
  , with
  <span class="pre">
   XX
  </span>
  indicating the target GPU architecture).
 </p>
 <p>
  Notice that PTX JIT is part of the JIT LTO kernel finalization trajectory, so architectures older than the current system architecture are supported; users can compile their callback function to LTO-IR for target arch
  <span class="pre">
   XX
  </span>
  and it should work in GPUs with arch
  <span class="pre">
   YY
  </span>
  , with
  <span class="pre">
   XX
  </span>
  <span class="pre">
   &lt;=
  </span>
  <span class="pre">
   YY
  </span>
  . Please see
  <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html#just-in-time-compilation">
   Just-in-Time Compilation
  </a>
  for more details.
 </p>
 <p>
  Once compiled to LTO-IR, the binary containing the callback can be turned into a header file containing a C array with the data using the
  <span class="pre">
   bin2c
  </span>
  application included in the CUDA Toolkit. The header then can be included in the application to pass the array to cuFFT.
 </p>
 <p>
  Please see the included samples in the
  <span class="xref std std-ref">
   cuFFT LTO EA tar ball
  </span>
  or the public
  <a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/cuFFT/lto_ea">
   CUDA Library Samples github repository
  </a>
  for more details.
 </p>
 <h3>
  Using NVRTC
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#using-nvrtc" title="Permalink to this heading">
   Â¶
  </a>
 </h3>
 <p>
  Another option to generate the LTO-callback is to use NVRTC to do runtime compilation.
 </p>
 <p>
  NVRTC supports the
  <span class="pre">
   -dlto
  </span>
  flag to compile the callback to LTO-IR at runtime.
 </p>
 <p>
  As stated in
  <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#offline-compilation">
   Offline compilation
  </a>
  , PTX JIT is part of the JIT LTO kernel finalization trajectory, so it is possible to compile the callback to any architecture older than the target architecture.
 </p>
 <p>
  Please see the included samples in the
  <span class="xref std std-ref">
   cuFFT LTO EA tar ball
  </span>
  for more details.
 </p>
 <h2>
  Associating the LTO callback with the cuFFT plan
  <a class="headerlink" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/api_usage.html#associating-the-lto-callback-with-the-cufft-plan" title="Permalink to this heading">
   Â¶
  </a>
 </h2>
 <p>
  Associating the LTO callback with cuFFT is done using the API extension in cuFFT LTO EA. Specifically we can use the new function
  <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#api-reference-cufftxtsetjitcallback-label">
   <span class="std std-ref">
    cufftXtSetJITCallback
   </span>
  </a>
  , which works similarly to
  <a class="reference external" href="https://docs.nvidia.com/cuda/cufft/index.html#function-cufftxtsetcallback">
   cufftXtSetCallback(â¦)
  </a>
  , with a few caveats.
 </p>
 <p>
  First,
  <a class="reference internal" href="https://docs.nvidia.com/cuda/cufft/ltoea/api/index.html#api-reference-cufftxtsetjitcallback-label">
   <span class="std std-ref">
    cufftXtSetJITCallback
   </span>
  </a>
  must be called after plan creation with
  <a class="reference external" href="https://docs.nvidia.com/cuda/cufft/index.html#function-cufftcreate">
   cufftCreate(â¦)
  </a>
  , and before calling the plan initialization function with
  <a class="reference external" href="https://docs.nvidia.com/cuda/cufft/index.html#cufft-basic-plans">
   cufftMakePlanâ¦(â¦)
  </a>
 </p>
 <p>
  Second, removing the LTO callback from the plan (using
  <a class="reference external" href="https://docs.nvidia.com/cuda/cufft/index.html#function-cufftxtclearcallback">
   cufftXtClearCallback(â¦)
  </a>
  is currently not supported. A new plan must be created.
 </p>
 <p>
  Setting the callback shared memory size via
  <a class="reference external" href="https://docs.nvidia.com/cuda/cufft/index.html#function-cufftxtsetcallbacksharedsize">
   cufftXtSetCallbackSharedSize(â¦)
  </a>
  is still supported.
 </p>
 <a accesskey="p" class="btn btn-neutral float-left" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/requirements.html" rel="prev" title="Requirements">
  Previous
 </a>
 <a accesskey="n" class="btn btn-neutral float-right" href="https://docs.nvidia.com/cuda/cufft/ltoea/usage/supported_functionalities.html" rel="next" title="Supported functionalities">
  Next
 </a>
 <p style="color: gray;">
  <a href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/" style="color: inherit;" target="_blank">
   Privacy Policy
  </a>
  |
  <a href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/" style="color: inherit;" target="_blank">
   Manage My Privacy
  </a>
  |
  <a href="https://www.nvidia.com/en-us/preferences/start/" style="color: inherit;" target="_blank">
   Do Not Sell or Share My Data
  </a>
  |
  <a href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/" style="color: inherit;" target="_blank">
   Terms of Service
  </a>
  |
  <a href="https://www.nvidia.com/en-us/about-nvidia/accessibility/" style="color: inherit;" target="_blank">
   Accessibility
  </a>
  |
  <a href="https://www.nvidia.com/en-us/about-nvidia/company-policies/" style="color: inherit;" target="_blank">
   Corporate Policies
  </a>
  |
  <a href="https://www.nvidia.com/en-us/product-security/" style="color: inherit;" target="_blank">
   Product Security
  </a>
  |
  <a href="https://www.nvidia.com/en-us/contact/" style="color: inherit;" target="_blank">
   Contact
  </a>
 </p>
 <p>
  Copyright © 2023-2024, NVIDIA Corporation and affiliates.
 </p>
</body>
</body></html>